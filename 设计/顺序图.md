#### 设计动态模型

## 1.Register

![RegisterUIMockUP](./Diagrams/RegisterUIMockUP.svg)

```PlantUML
@startsalt Diagrams/RegisterUIMockUP
{
    Welcome to AudioAR
    ==
    Login | "MyName"
    Email | "Development@AudioAR.org"
    Password | "******"
    Reenter Password | "******"
    passwordStrength <&check><&check><&check><&check><&x>
    [X] Remember me next time
    ==
    [Cancel] | [Register <&account-login>]
}
@endsalt
```

![SeqDiagram](./Diagrams/Register.svg)


```PlantUML
@startuml Diagrams/Register
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":LoginViewModel" as loginpage
participant ":RegisterViewModel" as boundary
participant ":UserInfoControl" as control
participant ":LocalVSSManagerViewModel" as nextpage

note right of control: The UserInfoControl is activated since the start of the entire program.

user -> loginpage: onRegisterButtonClicked(): void

create boundary
loginpage -> boundary: <<create>>

user -> boundary: onRememberButtonToggled(): void
loop not finished or incorrect or UserID is 0
    note right of user
        the UI will give the user some reaction if the form is not finished.
    end note
    user -> boundary: onChangeRegisterData(): void
    boundary -> boundary: checkInputLegitimate(): void
    boundary -> boundary: checkPasswordStrength(): int
    boundary -> control: isAvailable(): int
    control ->:RegisterRequest(username:String, password:String, email:String):int,input
    control <-:Response, UserID
    control->boundary:Response
    note left:若Response=-1则说明用户名已被注册，若Response=0则说明邮箱已被使用
end

boundary -> control: signUp(username: String, password: String, remember: boolean): boolean

control -> control: setCurrentUser(userID: int, username: String): void
alt remember me selected
    control -> control: rememberCurrentUser(): void
end
create nextpage
control -> nextpage: <<create>>
@enduml
```

## 1.1.Register

![RegisterServerSequence](./Diagrams/RRegisterServerSequence.svg)

```PlantUML
@startuml Diagrams/RRegisterServerSequence
hide footbox
skinparam sequenceParticipant underline
title Register
actor ":UserInfoControl" as Client
participant ":Communicator" as Communicator
participant ":WebServer" as WebServer
participant ":UserDatabase" as UserDatabase
Client->Communicator:RegisterRequest(username:String, password:String, email:String):int,int
Communicator->WebServer:RegisterRequest(username:String, password:String, email:String):int,int
WebServer->UserDatabase:Search(username:String, password:String, email:String):int, int
UserDatabase->UserDatabase:SearchUser(username:String, password:String, email:String):int,int
note left: 根据RegisterList提供的信息在User_Table中进行查询，\n若已存在相同的用户名则返回-1，若已存在相同的电子邮\n箱地址则返回0，若均不存在则返回1
alt Exist
  UserDatabase->WebServer:Response,0
  note left: 当SearchUser小于等于0的时候进入Exist\n并利用Response传递相应的信息
  WebServer->Communicator:Response,0
  Communicator->Client:Response,0
else NotExist
  UserDatabase->UserDatabase:AddUser(RegisterList):int,int
  note left: 根据RegisterList的内容更新User_Table\n并给该用户创建一个UserID传送到客户端
  UserDatabase->WebServer:1, UserID
  WebServer->Communicator:1, UserID
  Communicator->Client:1, UserID
end
@enduml
```

## 2.Login

![LoginUIMockUP](./Diagrams/LoginUIMockUP.svg)

```PlantUML
@startsalt Diagrams/LoginUIMockUP
{
    User Login Panel
    ==
    Username or Email | "someEmail@AudioAR.org"
    Password | "****"
    [X] Remember me next time
    ==
    [Sign IN <&account-login>]
    ==
    New to AudioAR? Click to register:
    [Sign UP <&key>]
}
@endsalt
```

![SeqDiagram](./Diagrams/Login.svg)

```PlantUML
@startuml Diagrams/Login
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":LoginViewModel" as boundary
participant ":UserInfoControl" as control
participant ":LocalVSSManagerViewModel" as nextpage


[-> boundary: <<create>>
user -> boundary: onLoginDataChanged(): void

boundary -> control: login(username: String, password: String, remember: boolean): int
control ->: LoginRequest(username: String, password: String):int,int
control <-:Response, UserID

loop UserID is 0(wrongPassword) / -1(nonexistent)
    alt nonexistent

        control -> boundary: alertUserNonexistent(): void
    else wrong password
        control -> boundary: alertPasswordError(): void
    end
    user -> boundary: onLoginDataChanged(): void
    boundary -> control: login(username: String, password: String, remember: boolean): boolean
    control ->: LoginRequest(username: String, password: String):int,int
    control <-:Response, UserID
end
control --> boundary: alertLoginSuccessed(): void
control -> control: setCurrentUser(userID: int, username: String): void

alt remember me selected
    control -> control: rememberCurrentUser(): void
end
create nextpage
control -> nextpage: <<create>>
@enduml
```

## 2.1.Login

![LoginServerSequenceDiagram](./Diagrams/LoginServerSequenceDiagram.svg)

```PlantUML
@startuml Diagrams/LoginServerSequenceDiagram.svg
hide footbox
title Login
skinparam sequenceParticipant underline
actor ":UserInfoControl" as Client
participant ":Communicator" as Communicator
participant ":WebServer" as WebServer
participant ":UserDatabase" as UserDatabase
Client->Communicator:LoginRequest(username: String, password: String):int,int
Communicator->WebServer:LoginRequest(username: String, password: String):int,int
WebServer->UserDatabase:Search(username: String, password: String):int,int
UserDatabase->UserDatabase:SearchUser(username: String, password: String):int,int
note left:根据登陆信息在User_Table中进行查询,\n如用户名不存在则返回-1，如用户名存在\n但是密码不匹配则返回0，如果用户名存在\n且密码匹配则返回1
alt Exist
  UserDatabase->WebServer:1, UserID
  note left: 当SearchUser的结果等于1时进入Exist，\n否则进入NotExist，并通过Response传\n递相应数值以及该用户对应的UserID
  WebServer->Communicator:1, UserID
  Communicator->Client:1, UserID
else NotExist
  UserDatabase->WebServer:Response, 0
  WebServer->Communicator:Response, 0
  Communicator->Client:Response, 0
end
@enduml
```

## 3.ManageLocalVSSLibrary

![LocalVSSManagerUIMockUP](./Diagrams/ManageLocalVSSLibraryUIMockUp.svg)

```PlantUML
<<<<<<< HEAD
@startsalt
=======
@startsalt Diagrams/ManageLocalVSSLibraryUIMockUp
>>>>>>> 8805b7800a9b610763d864f391ba2ec2b0950225
{
  User's LocalVSSManager
  ==
  {/ <b>LocalVSS | OnlineVSS }
  {+
    VSS1.vss
    --
    Description1
    [Delete] | [Rename]
    [Preview] | [Upload]
  }
  {+
    VSS2.vss
    --
    Description2
    [Delete] | [Rename]
    [Preview] | [Upload]
  }
  ==
  [Create]
  {[Prev]|[Next]}
}
@endsalt
```

![SeqDiagram](./Diagrams/ManageLocalVSSLibrary.svg)

```PlantUML
@startuml Diagrams/ManageLocalVSSLibrary
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":LocalVSSManagerViewModel" as boundary
participant ":LocalSoundSpaceLibrary" as library

create boundary
[-> boundary: <<create>>
boundary -> library: getVSSList(pageNo: int): List
library --> boundary: listOfLocalVSS: List<VirtualSoundSpace>
boundary -> boundary: displayVSSList(listOfLocalVSS)

loop
    alt CreateVSS
        user -> boundary: createVSS
        ...described in PlayVSS...
    else RenameVSS
        user -> boundary: renameVSS(whichVSS)
        ...described in RenameVSS...
    else DeleteVSS
        user -> boundary: deleteVSS(whichVSS)
        ...described in DeleteVSS...
    else UploadVSS
        user -> boundary: uploadVSS(whichVSS)
        ...described in UploadVSS...
    else PreviewVSS
        user -> boundary: previewVSS(whichVSS)
        boundary -> boundary: previewVSS(whichVSS)
        alt local map
            participant ":PreviewLocalMapPage" as plmp
            create plmp
            boundary -> plmp: <<create>>

        else local concert
            participant ":PreviewLocalConcertPage" as plcp
            create plcp
            boundary -> plcp: <<create>>
        end
    else prevPage
        user -> boundary: prevPage()
        boundary -> boundary: prevPage()
        boundary -> library: getVSSList(nextPageNo)
        library --> boundary: listOfLocalVSS: List<VirtualSoundSpace>
        boundary -> boundary: displayVSSList(listOfLocalVSS)
    else nextPage
    ...similar, omitted...
    end
end
@enduml
```

## 4.CreateVSS

![CreateVSSUIMockUP](./Diagrams/CreateVSSUIMockUP.svg)

```plantUML
@startsalt
{+
	Please Choose A Mode
	==
    {[MapMode] | [ConcertMode]}
}
@endsalt
```



![SeqDiagram](./Diagrams/CreateVSS.svg)

```PlantUML
@startuml Diagrams/CreateVSS
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":LocalVSSManagerViewModel" as manage
participant ":CreateVSSViewModel" as page
participant ":CreateMapVSSViewModel" as map
participant ":CreateConcertVSSViewModel" as concert

user -> manage: createVSS
create page
manage -> page: <<create>>
alt create Map Mode VSS
    user -> page: createMapModeVSS
    create map
    page -> map: <<create>>
    ...Go to CreateMapVSS...
else create Concert Mode VSS
    user -> page: createConcertModeVSS
    create concert
    page -> concert: <<create>>
    ...Go to CreateConcertModeVSS...
end

@enduml
```

## 5.CreateMapModeVSS

![SeqDiagram](./Diagrams/CreateMapModeVSS.svg)

```PlantUML
@startuml Diagrams/CreateMapModeVSS
hide footbox
skinparam sequenceParticipant underline


actor User as user
participant ":CreateMapVSSViewModel" as createboundary
participant ":LocalSoundSpaceLibrary" as library
participant ":Sensor" as sensor
participant "newSoundSpace:MapModeVirtualSoundSpace" as newspace


[-> createboundary: <<create>>
create newspace
createboundary -> newspace: <<create>>
create sensor
createboundary -> sensor: <<create>>
loop add virual sound source
    alt add from library
        note right of user: Notice that there are no shared SoundSources here, each time, only the SoundFragment object is reused.
        user -> createboundary: selectExistedSoundSource
        createboundary -> library: getLocalSoundFragments
        library --> createboundary: filteredSoundFragments
        createboundary --> createboundary: displayAvailableLocalSoundFragments
        user -> createboundary: selectSoundFragment
        createboundary -> createboundary: addSoundFragment
    else add from file
        user -> createboundary: selectFromFileSystem
        ...somehow CreateMapVSSControl got the new SoundFragment # specify during implementation...

    end

    createboundary -> sensor: getCurrentLocation()
    sensor --> createboundary: currentLocation: Position

    participant ":SoundSource" as source
    create source
    createboundary -> source: <<create>>
    createboundary -> source: setSoundFragment
    createboundary -> source: setLocation

    alt user choose to alter position
        user -> createboundary: setCurrentSoundSourceLocation
        createboundary -> source: setLocation
    end
    user -> createboundary: setSoundSourceMode
    createboundary -> source: setSoundSourceMode
    alt confirm
        createboundary -> newspace: addSoundSource(soundSource)
    else cancel
        createboundary -> newspace: <<destroy>>
        destroy newspace
    end
end
user -> createboundary: setVSSNameAndDescription
createboundary -> newspace: setVSSNameAndDescription
alt confirm
    user -> createboundary: comfirmVSSCreation
    createboundary -> createboundary: comfirmVSSCreation
    createboundary -> library: addSoundSpace(newSoundSpace)
else cancel

end
createboundary -> createboundary: <<destroy>>
createboundary -> sensor: <<destroy>>
destroy sensor
destroy createboundary
@enduml
```

## 6.CreateConcertModeVSS

![SeqDiagram](./Diagrams/CreateConcertModeVSS.svg)

```PlantUML
@startuml Diagrams/CreateConcertModeVSS
hide footbox
skinparam sequenceParticipant underline


actor User as user
participant ":CreateConcertVSSViewModel" as createboundary
participant ":LocalSoundSpaceLibrary" as library
participant "newSoundSpace:ConcertModeVirtualSoundSpace" as newspace

create createboundary
-> createboundary: <<create>>
create newspace
createboundary -> newspace: <<create>>

loop add virual sound source
    alt add from library
        note right of user: Notice that there are no shared SoundSources here, each time, only the SoundFragment object is reused.
        user -> createboundary: selectExistedSoundSource
        createboundary -> library: getLocalSoundFragments
        library --> createboundary: filteredSoundFragments
        createboundary --> createboundary: displayAvailableLocalSoundFragments
        user -> createboundary: selectSoundFragment
        createboundary -> createboundary: addSoundFragment
    else add from file
        user -> createboundary: selectFromFileSystem
        ...somehow CreateMapVSSControl got the new SoundFragment # specify during implementation...
    end


    participant ":SoundSource" as source
    user -> user: wakeUp(self)
    create source
    createboundary -> source: <<create>>
    createboundary -> source: setSoundFragment
    alt confirm
        user -> createboundary: confirmAddition
        createboundary -> createboundary: confirmAddition
        createboundary -> newspace: addSoundSource(soundSource)
    else cancel
        user -> createboundary: cancelAddition
        createboundary -> createboundary: confirmAddition
        createboundary -> newspace: <<destroy>>
        destroy newspace
    end

end
user -> createboundary: setVSSNameAndDescription
createboundary -> newspace: setVSSNameAndDescription
alt confirm
    user -> createboundary: comfirmVSSCreation
    createboundary -> createboundary: comfirmVSSCreation
    createboundary -> library: addSoundSpace(newSoundSpace)
else cancel
end
createboundary -> createboundary: <<destroy>>
destroy createboundary
@enduml
```

## 7.RenameVSS

**The LocalSoundSpaceLibrary acts like a facade.**

![SeqDiagram](./Diagrams/RenameVSS.svg)

```PlantUML
@startuml Diagrams/RenameVSS
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":LocalVSSManagerViewModel" as page
participant ":LocalSoundSpaceLibrary" as library

user -> page: renameVSS
user -> page: enterNewLocalVSSNameAndDescription
page -> page: newNameAndDescriptionEntered(whichVSS, newName, newDescription)
page -> page: checkNewNameAndDescription
alt wrong input
    page -> page: notifyWrongInput
else good input
    page -> library: setNameAndDescription(whichVSS, newName, newDescription)
end

@enduml
```

## 8.DeleteVSS
![SeqDiagram](./Diagrams/DeleteVSS.svg)

```PlantUML
@startuml Diagrams/DeleteVSS
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":LocalVSSManagerViewModel" as page
participant ":LocalSoundSpaceLibrary" as library

user -> page: deleteVSS(whichVSS)
page -> page: deleteVSS(whichVSS)
page -> page: comfirmDialog
alt confirm
    user -> page: confirmDelete
    page -> page: confirm
    page -> library: deleteVSS(whichVSS)
    page -> library: getVSSList(pageNo)
    library --> page: listOfLocalVSS
    library -> page: displayVSSList(listOfLocalVSS)
else cancel
    user -> page: cancelDelete
    page -> page: cancelDelete
end


@enduml
```

## 9.UploadVSS
![SeqDiagram](./Diagrams/UploadVSS.svg)

```PlantUML
@startuml Diagrams/UploadVSS
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":LocalVSSManagerPage" as page
participant ":LocalVSSLibraryControl" as control
participant ":LocalSoundSpaceLibrary" as library

user -> page: uploadVSS(whichVSS)
page -> control: uploadVSS(whichVSS)
control -> library: beamMeUp(whichVSS)
...LocalSoundSpaceLibrary doing magic trick, using android system to show download progress...
...There are no other ways to show that a local sound space is finished uploading other than android system notices...
@enduml
```

## 10. LikeVSS
![SeqDiagram](./Diagrams/LikeVSS.svg)

```PlantUML
@startuml Diagrams/LikeVSS
hide footbox
skinparam sequenceParticipant underline
actor User as user
participant ":PreviewOnline***Page" as page
participant ":PreviewOnline***Control" as control
participant ":UserInfoControl" as info
participant ":OnlineSoundSpaceLibrary" as library

user -> page: toggleLikeStatus
alt not liked
    page -> control: likeVSS
    control -> info: getCurrentUserID()
    info --> control: currentUserID
    control -> library: addLike(thisVSS)
else already liked
    page -> control: dislikeVSS
    control -> info: getCurrentUserID()
    info --> control: currentUserID
    control -> library: removeLike(thisVSS)
end

@enduml
```


## 11. DownloadVSS
![SeqDiagram](./Diagrams/DownloadVSS.svg)

```PlantUML
@startuml Diagrams/DownloadVSS
hide footbox
skinparam sequenceParticipant underline
actor User as user
participant ":PreviewOnline***Page" as page
participant ":PreviewOnline***Control" as control
participant ":LocalSoundSpaceLibrary" as library
user -> page: downloadVSS
page -> control: downloadVSS
control -> library: downloadVSS(thisVSS)



@enduml
```

## 12. CommentVSS
![SeqDiagram](./Diagrams/CommentVSS.svg)

```PlantUML
@startuml Diagrams/CommentVSS
hide footbox
skinparam sequenceParticipant underline
actor User as user
participant ":PreviewOnline***Page" as page
participant ":PreviewOnline***Control" as control
participant ":UserInfoControl" as info
participant ":OnlineSoundSpaceLibrary" as library

user -> page: submitComment(comment: String)
page -> control: submitComment(commit: String)
control -> info: getCurrentUserID()
info --> control: currentUserID
control -> library: addCommit(whichVSS, userid, comment)
@enduml
```


## 13. PlayVSS(Abstract)

## 14. PreviewVSS(Abstract)

## 15. PreviewLocalMapVSS
![SeqDiagram](./Diagrams/PreviewLocalMapVSS.svg)

```PlantUML
@startuml Diagrams/PreviewLocalMapVSS
hide footbox
skinparam sequenceParticipant underline
participant ":PreviewLocalMapPage" as page
participant ":PreviewLocalMapControl" as control
participant "localMapVSS:VirtualSoundSpace" as vss
create page
[-> page: <<create>>
create control
page -> control: <<create>>
control -> vss: get metadata
vss --> control: metadata
control -> page: display metadata



@enduml
```


## 16. PreviewOnlineMapVSS
![SeqDiagram](./Diagrams/PreviewOnlineMapVSS.svg)

```PlantUML
@startuml Diagrams/PreviewOnlineMapVSS
hide footbox
skinparam sequenceParticipant underline
actor User as user

participant ":PreviewOnlineMapPage" as page
participant ":PreviewOnlineMapControl" as control
participant "onlineMapVSS:VirtualSoundSpace" as vss
create page
[-> page: <<create>>
create control
page -> control: <<create>>
control -> vss: get metadata
vss -> control: metadata
control -> page: display metadata
note right
details are left out for designs.
end note
@enduml
```

## 17. PreviewLocalConcertVSS
![SeqDiagram](./Diagrams/PreviewLocalConcertVSS.svg)

```PlantUML
@startuml Diagrams/PreviewLocalConcertVSS
hide footbox
skinparam sequenceParticipant underline
actor User as user

participant ":PreviewLocalConcertPage" as page
participant ":PreviewLocalConcertControl" as control
participant "localConcertVSS:VirtualSoundSpace" as vss
create page
[-> page: <<create>>
create control
page -> control: <<create>>
control -> vss: get metadata
vss -> control: metadata
control -> page: display metadata
note right
details are left out for designs.
end note
@enduml
```


## 18. PreviewOnlineConcertVSS
![SeqDiagram](./Diagrams/PreviewOnlineConcertVSS.svg)

```PlantUML
@startuml Diagrams/PreviewOnlineConcertVSS
hide footbox
skinparam sequenceParticipant underline
actor User as user

participant ":PreviewConcer" as page
participant ":PreviewOnlineConcertPage" as control
participant "onlineConcertVSS:VirtualSoundSpace" as vss
create page
[-> page: <<create>>
create control
page -> control: <<create>>
control -> vss: get metadata
vss -> control: metadata
control -> page: display metadata
note right
details are left out for designs.
end note
@enduml
```


## 19. PlayMapModeVSS
![SeqDiagram](./Diagrams/PlayMapModeVSS.svg)

```PlantUML
@startuml Diagrams/PlayMapModeVSS
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":PlayMapModeVSSPage" as page
participant ":MapVSSPlayControl" as control
participant ":LocalSoundSpaceLibrary" as library
participant "thisVSS:MapModeVirtualSoundSpace" as vss
participant ":Sensor" as sensor
participant ":GVRAudioEngine" as audio
participant ":AdjustSensorPage" as adpage
participant "task:Callable" as task

create page
[-> page: <<create>>
create control
page -> control: <<create>>
control -> library: checkAllNessarySoundFragmentDownloaded()
alt downloaded
    library --> control: confirm
else not yet
    library --> control: deny
    control -> page: warning
    control -> page: <<destroy>>
    destroy control
    destroy page
end
control -> vss: getSoundSources()
vss --> control: soundSourceList
control -> page: displaySoundSourceList
create sensor
control -> sensor: <<create>>
create audio
control -> audio: <<create>>
create adpage
control -> adpage: <<create>>
...adjust sensor...
user -> user: wakeup
destroy adpage
create task
control -> task: new Callable()
control -> sensor: callWhenUpdatedDelay(task, 50)

loop
    sensor --\ control: currentLocation: Positon
    control -> audio: updateCurrentLocation(currentLocation: Position)

    alt startPlay
        user -> page: play(soundSource)
        page -> control: play(soundSource)
        control -> audio: play(soundFragment)
    else pause
        user -> page: pause()
        page -> control: pause()
        control -> audio: pause()
    else next
        user -> page: next()
        page -> control: play(soundSource)
        control -> audio: play(soundFragment)
    else prev
        user -> page: prev()
        page -> control: play(soundSource)
        control -> audio: play(soundFragment)
    end
end
control -> sensor: clearTask()
control -> audio: stopAll()
control -> audio: <<destroy>>
destroy audio
control -> sensor: <<destroy>>
destroy sensor
control -> page: <<destroy>>
destroy page
destroy control


@enduml
```


## 20. PlayConcertModeVSS
![SeqDiagram](./Diagrams/PlayConcertModeVSS.svg)

```PlantUML
@startuml Diagrams/PlayConcertModeVSS
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":PlayConcertModeVSSPage" as page
participant ":ConcertVSSPlayControl" as control
participant ":ConcertModeVirtualSoundSpace" as vss
participant ":LocalSoundSpaceLibrary" as library
participant ":Sensor" as sensor
participant ":GVRAudioEngine" as audio
participant ":AdjustSensorPage" as adpage
participant "task:Callable" as task


create page
[-> page: <<create>>
create control
page -> control: <<create>>
control -> library: checkAllNessarySoundFragmentDownloaded()
alt downloaded
    library --> control: confirm
else not yet
    library --> control: deny
    control -> page: warning
    control -> page: <<destroy>>
    destroy control
    destroy page
end
control -> vss: getSoundSources()
vss --> control: soundSourceList
control -> page: displaySoundSourceList
create sensor
control -> sensor: <<create>>
create audio
control -> audio: <<create>>
create adpage
control -> adpage: <<create>>
...adjust sensor...
user -> user: wakeup
destroy adpage
create task
control -> task: new Callable()
control -> sensor: callWhenUpdatedDelay(task, 50)
loop
    sensor --\ control: currentLocation: Positon
    control -> audio: updateCurrentLocation(currentLocation: Position)
    alt startPlay
        user -> page: play(soundSource)
        page -> control: play(soundSource)
        control -> audio: play(soundFragment)
    else pause
        user -> page: pause()
        page -> control: pause()
        control -> audio: pause()
    else next
        user -> page: next()
        page -> control: play(soundSource)
        control -> audio: play(soundFragment)
    else prev
        user -> page: prev()
        page -> control: play(soundSource)
        control -> audio: play(soundFragment)
    end
end
control -> audio: stopAll()
control -> audio: <<destroy>>
destroy audio
control -> sensor: <<destroy>>
destroy sensor
control -> page: <<destroy>>
destroy page
destroy control

@enduml
```


## 21. BrowseOnlineVSSLibrary
![SeqDiagram](./Diagrams/BrowseOnlineVSSLibrary.svg)

```PlantUML
@startuml Diagrams/BrowseOnlineVSSLibrary
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":OnlineVSSViewerPage" as page
participant ":OnlineVSSLibraryControl" as control
participant ":OnlineSoundSpaceLibrary" as library



create page
[-> page: <<create>>
create control
page -> control: <<create>>
control -> library: getVSSList(pageNo: int):List
library --> control: listOfOnlineVSS: List<VirtualSoundSpace>
control -> page: displayVSSList(listOfOnlineVSS)
alt previewVSS
    user -> page: previewVSS(whichVSS)
    page -> control: previewVSS(whichVSS)
    alt concert mode vss is selected
        participant ":PreviewOnlineConcertPage" as pocp
        create pocp
        control -> pocp: <<create>>
    else map mode vss is selected
        participant ":PreviewOnlineMapPage" as pomp
        create pomp
        control -> pomp: <<create>>

    end
else nextPage
    control -> library: getVSSList(pageNo: int):List
    library --> control: listOfOnlineVSS: List<VirtualSoundSpace>
    control -> page: displayVSSList(listOfOnlineVSS)
else prevPage
    control -> library: getVSSList(pageNo: int):List
    library --> control: listOfOnlineVSS: List<VirtualSoundSpace>
    control -> page: displayVSSList(listOfOnlineVSS)
end

@enduml
```

## 22. AdjustSensor
![SeqDiagram](./Diagrams/AdjustSensor.svg)

**AdjustSensor用例中Sensor 和 Control 高度耦合，而且具体的步骤需要等到技术开发结束才能知道，因此暂时放在这里。**

```PlantUML
@startuml Diagrams/AdjustSensor
hide footbox
skinparam sequenceParticipant underline

actor User as user
participant ":AdjustSensorPage" as page
participant ":AdjustSensorControl" as control
participant ":Sensor" as sensor

[-> page: <<create>>
note over control: Sensor control should be coupled with Sensor
create control
page -> control: <<create>>
note right of sensor: this sensor object is created before adjusting sensor
loop for each operation
    control -> page: demand
    page -> user: demand
    loop while adjust demand satisfied
        user -> user: move
        sensor -> sensor: collectData
    end
    sensor -> control: demandSatisfied
end

control -> page: <<destroy>>
destroy page
destroy control



@enduml
```
